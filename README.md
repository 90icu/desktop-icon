# 桌面图标管理

保存和恢复 Windows 桌面图标位置的工具，支持多显示器和多套布局配置。

## 功能

- **多布局管理**：创建并命名多套图标布局，随时切换
- **保存布局**：记录所有桌面图标的位置、所在显示器及网格坐标
- **恢复布局**：将图标精确还原到保存时的位置，支持跨显示器
- **布局预览**：以可视化方式展示各显示器上的图标分布
- **布局匹配提示**：自动检测当前显示器配置是否与某套布局匹配（标注 ⭐）
- **托盘运行**：最小化后驻留系统托盘，可从托盘菜单快速恢复布局
- **多显示器支持**：按设备名匹配显示器，适应显示器增减或换接场景

## 环境要求

- Windows 10 / 11（64位）
- Python 3.10+（仅开发/调试时需要）

## 依赖安装

```bash
pip install ttkbootstrap pywin32 pystray pillow pyinstaller
```

或使用 `requirements.txt`：

```bash
pip install -r requirements.txt
```

> `requirements.txt` 目前只列出了核心依赖，完整依赖通过上方命令安装。

## 直接运行（开发模式）

```bash
python main_gui.py
```

## 打包为 exe

项目使用 PyInstaller 打包为单文件 exe，打包配置已写好在 `DesktopManager_v4.spec`。

**前置条件**：项目根目录下需要存在 `app.ico`（窗口及任务栏图标）。

```bash
python -m PyInstaller DesktopManager_v4.spec --noconfirm
```

打包完成后，exe 文件输出到 `dist\桌面图标管理.exe`，双击即可运行，无需安装 Python 环境。

## 使用说明

### 新建布局
1. 点击右上角 **➕ 新增配置**
2. 在输入框中填写布局名称
3. 点击 **保存** 按钮，当前所有桌面图标位置将被记录

### 恢复布局
- 点击对应布局行的 **恢复** 按钮，图标将自动移动到保存时的位置
- 也可在系统托盘图标的右键菜单中直接选择要恢复的布局

### 查看布局预览
- 点击 **布局** 按钮，弹出可视化窗口
- 每个显示器以矩形表示，顶部信息栏显示编号、分辨率、刷新率和坐标位置
- 黄色圆点表示该显示器上的图标位置（主显示器以蓝色背景区分）
- 点击顶部 **🖥️ 显示器布局** 按钮可查看当前实时布局

### 托盘功能
- 点击窗口最小化按钮，程序自动缩小到系统托盘
- 右键托盘图标可快速恢复任意已保存的布局
- 点击"显示主界面"可重新打开主窗口

## 数据文件

布局数据保存在程序同目录下的 `desktop_layouts.json`，格式为 JSON，可手动备份。

## 项目结构

```
desktop-icon/
├── main_gui.py              # 主界面（UI + 交互逻辑）
├── desktop_manager.py       # 核心逻辑（图标读写、显示器枚举）
├── DesktopManager_v4.spec   # PyInstaller 打包配置
├── requirements.txt         # 依赖清单
├── app.ico                  # 应用图标（打包时需要）
└── desktop_layouts.json     # 布局数据（运行后自动生成）
```

## 注意事项

- 恢复布局前，建议确保桌面的"自动排列图标"已关闭（右键桌面 → 查看 → 取消勾选"自动排列图标"）
- 若显示器分辨率或排列方式发生变化，布局匹配标识（⭐）将不再显示，恢复效果可能偏移
- 程序需要访问 explorer.exe 进程内存，在某些安全策略严格的环境下可能受限
